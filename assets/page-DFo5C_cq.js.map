{"version":3,"file":"page-DFo5C_cq.js","sources":["../../src/pages/popup/customer-search/page.tsx"],"sourcesContent":["\n\nimport { useState, useEffect, useCallback, Suspense } from \"react\";\nimport { useSearchParams } from \"@/lib/hooks/useAppLocation\";\nimport { DataTable } from \"@/components/app/DataTable\";\nimport { FilterContainer } from \"@/components/filters/FilterContainer\";\nimport { PopupRightActions, PopupAction } from \"@/components/app/PopupRightActions\";\nimport type { FilterLayout } from \"@/components/filters/types\";\nimport { ColumnDef } from \"@tanstack/react-table\";\n\n// Data type for the table\ntype CustomerData = {\n  id: number;\n  realNameNumber: string;\n  centralCustomerNumber: string;\n  customerName: string;\n  accountNumber: string;\n  accountStatus: string;\n};\n\n// Mock data for the table\nconst mockData: CustomerData[] = [\n  {\n    id: 1,\n    realNameNumber: \"850315-1XXXXXX\",\n    centralCustomerNumber: \"CUST1001\",\n    customerName: \"김고객1\",\n    accountNumber: \"110-234-567890\",\n    accountStatus: \"정상\",\n  },\n  {\n    id: 2,\n    realNameNumber: \"921101-2XXXXXX\",\n    centralCustomerNumber: \"CUST1002\",\n    customerName: \"이고객2\",\n    accountNumber: \"110-234-567891\",\n    accountStatus: \"해지\",\n  },\n  {\n    id: 3,\n    realNameNumber: \"010520-3XXXXXX\",\n    centralCustomerNumber: \"CUST1003\",\n    customerName: \"박고객3\",\n    accountNumber: \"110-234-567892\",\n    accountStatus: \"정상\",\n  },\n  {\n    id: 4,\n    realNameNumber: \"780830-1XXXXXX\",\n    centralCustomerNumber: \"CUST1004\",\n    customerName: \"최고객4\",\n    accountNumber: \"110-234-567893\",\n    accountStatus: \"해지\",\n  },\n  {\n    id: 5,\n    realNameNumber: \"051225-4XXXXXX\",\n    centralCustomerNumber: \"CUST1005\",\n    customerName: \"정고객5\",\n    accountNumber: \"110-234-567894\",\n    accountStatus: \"정상\",\n  },\n];\n\n// Column definitions for the table\nconst columns: ColumnDef<CustomerData>[] = [\n  { accessorKey: \"id\", header: \"순번\" },\n  { accessorKey: \"realNameNumber\", header: \"실명번호\" },\n  { accessorKey: \"centralCustomerNumber\", header: \"중앙회고객번호\" },\n  { accessorKey: \"customerName\", header: \"고객명\" },\n  { accessorKey: \"accountNumber\", header: \"계좌번호\" },\n  { accessorKey: \"accountStatus\", header: \"계좌상태\" },\n];\n\n// DSL for the filter section\nconst filterLayout: FilterLayout = [\n    {\n        type: \"grid\",\n        columns: 3,\n        filters: [\n            { name: \"birthDate\", type: \"date\", label: \"생년월일\" },\n            { name: \"customerNumber\", type: \"text\", label: \"고객번호\" },\n            { name: \"customerName\", type: \"text\", label: \"고객명\" },\n        ],\n    },\n    {\n        type: \"grid\",\n        columns: 2,\n        filters: [\n            { name: \"extendedSearch\", type: \"checkbox\", label: \"확장검색\" },\n            { name: \"accountNumber\", type: \"text\", label: \"계좌번호\" },\n        ],\n    },\n];\n\nimport { postPopupMessage } from \"@/lib/popup-bus\";\n\n// ... (imports)\n\nfunction CustomerSearchPopupContent() {\n  const searchParams = useSearchParams();\n  const [filters, setFilters] = useState<Record<string, any>>({});\n  const [selectedRow, setSelectedRow] = useState<CustomerData | null>(null);\n  const openerTabId = searchParams.get(\"openerTabId\");\n\n  useEffect(() => {\n    const newFilters: Record<string, any> = {};\n    const customerNumber = searchParams.get(\"customerNumber\");\n    const customerName = searchParams.get(\"customerName\");\n    const birthDate = searchParams.get(\"birthDate\");\n    const accountNumber = searchParams.get(\"accountNumber\");\n    const extendedSearch = searchParams.get(\"extendedSearch\");\n\n    if (customerNumber) newFilters.customerNumber = customerNumber;\n    if (customerName) newFilters.customerName = customerName;\n    if (birthDate) newFilters.birthDate = birthDate;\n    if (accountNumber) newFilters.accountNumber = accountNumber;\n    if (extendedSearch) newFilters.extendedSearch = extendedSearch === 'true';\n\n    setFilters(newFilters);\n  }, [searchParams]);\n\n  const handleFilterChange = useCallback((name: string, value: any) => {\n    setFilters((prev) => ({ ...prev, [name]: value }));\n  }, []);\n  \n  const handleReset = () => {\n    setFilters({});\n    setSelectedRow(null);\n  }\n\n  const handleProcess = () => {\n    if (selectedRow) {\n      handleRowDoubleClick(selectedRow);\n    } else {\n      alert(\"처리할 행을 선택해주세요.\");\n    }\n  };\n\n  const popupActions: PopupAction[] = [\n    { id: \"search\", text: \"조회\" },\n    { id: \"process\", text: \"처리\", onClick: handleProcess },\n    { id: \"reset\", text: \"초기화\", onClick: handleReset },\n    { id: \"close\", text: \"닫기\", onClick: () => window.close() },\n  ];\n\n  const handleRowDoubleClick = (row: CustomerData) => {\n    const sourceFilter = searchParams.get(\"sourceFilter\");\n    if (openerTabId) {\n      postPopupMessage({\n        targetTabId: openerTabId,\n        source: 'customer-search',\n        payload: {\n          ...row,\n          sourceFilter,\n        },\n      });\n      window.close();\n    } else {\n      // openerTabId가 없는 경우, 아무것도 하지 않고 함수를 종료합니다.\n      // console.error(\"Opener Tab ID is missing, cannot send data.\"); // 더 이상 에러를 기록하지 않습니다.\n      return;\n    }\n  };\n\n  return (\n    <div className=\"flex flex-col gap-4 p-4 bg-gray-50 min-h-screen\">\n      <div className=\"flex justify-between items-center\">\n        <h2 className=\"text-xl font-bold\">고객검색</h2>\n        <PopupRightActions actions={popupActions} />\n      </div>\n\n      <div className=\"border-t pt-4\">\n        <h3 className=\"font-semibold mb-2\">검색조건</h3>\n        <FilterContainer\n          filterLayout={filterLayout}\n          values={filters}\n          onChange={handleFilterChange}\n        />\n      </div>\n\n      <div className=\"flex-grow\">\n        <DataTable \n          title=\"검색내용\"\n          columns={columns} \n          data={mockData} \n          onRowClick={setSelectedRow}\n          onRowDoubleClick={handleRowDoubleClick} \n        />\n      </div>\n    </div>\n  );\n}\n\nexport default function CustomerSearchPopupPage() {\n  return (\n    <Suspense fallback={<div>Loading...</div>}>\n      <CustomerSearchPopupContent />\n    </Suspense>\n  );\n}"],"names":["mockData","columns","filterLayout","CustomerSearchPopupContent","searchParams","useSearchParams","filters","setFilters","useState","selectedRow","setSelectedRow","openerTabId","useEffect","newFilters","customerNumber","customerName","birthDate","accountNumber","extendedSearch","handleFilterChange","useCallback","name","value","prev","popupActions","handleRowDoubleClick","row","sourceFilter","postPopupMessage","jsxs","jsx","PopupRightActions","FilterContainer","DataTable","CustomerSearchPopupPage","Suspense"],"mappings":"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"}