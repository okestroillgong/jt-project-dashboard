{"version":3,"file":"page-dcGdyTx4.js","sources":["../../src/pages/popup/branch-management/page.tsx"],"sourcesContent":["\n\nimport { useState, useEffect, useCallback, Suspense } from \"react\";\nimport { useSearchParams } from \"@/lib/hooks/useAppLocation\";\nimport { DataTable } from \"@/components/app/DataTable\";\nimport { FilterContainer } from \"@/components/filters/FilterContainer\";\nimport { PopupRightActions, PopupAction } from \"@/components/app/PopupRightActions\";\nimport type { FilterLayout } from \"@/components/filters/types\";\nimport { ColumnDef } from \"@tanstack/react-table\";\n\n// Data type for the table\ntype BranchData = {\n  id: number;\n  branchCode: string;\n  branchName: string;\n  parentBranch: string;\n  commonCode: string;\n};\n\n// Mock data for the table\nconst mockData: BranchData[] = Array.from({ length: 8 }, (_, i) => ({\n  id: i + 1,\n  branchCode: `B${100 + i}`,\n  branchName: `강남${i + 1}지점`,\n  parentBranch: \"강남본점\",\n  commonCode: `C${2000 + i}`,\n}));\n\n// Column definitions for the table\nconst columns: ColumnDef<BranchData>[] = [\n  { accessorKey: \"id\", header: \"순번\" },\n  { accessorKey: \"branchCode\", header: \"부점코드\" },\n  { accessorKey: \"branchName\", header: \"부점명\" },\n  { accessorKey: \"parentBranch\", header: \"상위부점\" },\n  { accessorKey: \"commonCode\", header: \"금융기관공통코드\" },\n];\n\n// DSL for the filter section\nconst filterLayout: FilterLayout = [\n    {\n        type: \"grid\",\n        columns: 2,\n        filters: [\n            { name: \"branchCode\", type: \"text\", label: \"부점코드\" },\n            { name: \"branchName\", type: \"text\", label: \"부점명\" },\n        ],\n    },\n    {\n        type: \"grid\",\n        columns: 1,\n        filters: [\n            { \n              name: \"includeClosed\", \n              type: \"select\", \n              label: \"폐점검색\", \n              options: [\n                { value: \"include\", label: \"포함\" },\n                { value: \"exclude\", label: \"미포함\" },\n              ],\n              defaultValue: \"exclude\",\n            },\n        ],\n    },\n];\n\nimport { postPopupMessage } from \"@/lib/popup-bus\";\n\n// ... (imports)\n\nfunction BranchManagementPopupContent() {\n  const searchParams = useSearchParams();\n  const [filters, setFilters] = useState<Record<string, any>>({});\n  const [selectedRow, setSelectedRow] = useState<BranchData | null>(null);\n  const openerTabId = searchParams.get(\"openerTabId\");\n\n  useEffect(() => {\n    const newFilters: Record<string, any> = {};\n    const branchCode = searchParams.get(\"branchCode\");\n    const branchName = searchParams.get(\"branchName\");\n\n    if (branchCode) newFilters.branchCode = branchCode;\n    if (branchName) newFilters.branchName = branchName;\n\n    setFilters(newFilters);\n  }, [searchParams]);\n\n  const handleFilterChange = useCallback((name: string, value: any) => {\n    setFilters((prev) => ({ ...prev, [name]: value }));\n  }, []);\n  \n  const handleReset = () => {\n    setFilters({});\n    setSelectedRow(null);\n  }\n\n  const handleProcess = () => {\n    if (selectedRow) {\n      handleRowDoubleClick(selectedRow);\n    } else {\n      alert(\"처리할 행을 선택해주세요.\");\n    }\n  };\n\n  const popupActions: PopupAction[] = [\n    { id: \"search\", text: \"조회\" },\n    { id: \"process\", text: \"처리\", onClick: handleProcess },\n    { id: \"reset\", text: \"초기화\", onClick: handleReset },\n    { id: \"close\", text: \"닫기\", onClick: () => window.close() },\n  ];\n\n  const handleRowDoubleClick = (row: BranchData) => {\n    if (openerTabId) {\n      postPopupMessage({\n        targetTabId: openerTabId,\n        source: 'branch-management',\n        payload: row,\n      });\n      window.close();\n    } else {\n      console.error(\"Opener Tab ID is missing, cannot send data.\");\n    }\n  };\n\n  return (\n    <div className=\"flex flex-col gap-4 p-4 bg-gray-50 min-h-screen\">\n      <div className=\"flex justify-between items-center\">\n        <h2 className=\"text-xl font-bold\">부점검색</h2>\n        <PopupRightActions actions={popupActions} />\n      </div>\n\n      <div className=\"border-t pt-4\">\n        <FilterContainer\n          filterLayout={filterLayout}\n          values={filters}\n          onChange={handleFilterChange}\n        />\n      </div>\n\n      <div className=\"flex-grow\">\n        <DataTable \n          title=\"검색내용\"\n          columns={columns} \n          data={mockData} \n          onRowClick={setSelectedRow}\n          onRowDoubleClick={handleRowDoubleClick} \n        />\n      </div>\n    </div>\n  );\n}\n\nexport default function BranchManagementPopupPage() {\n  return <BranchManagementPopupContent />;\n}\n"],"names":["mockData","_","i","columns","filterLayout","BranchManagementPopupContent","searchParams","useSearchParams","filters","setFilters","useState","selectedRow","setSelectedRow","openerTabId","useEffect","newFilters","branchCode","branchName","handleFilterChange","useCallback","name","value","prev","popupActions","handleRowDoubleClick","row","postPopupMessage","jsxs","jsx","PopupRightActions","FilterContainer","DataTable","BranchManagementPopupPage"],"mappings":"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"}