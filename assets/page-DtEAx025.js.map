{"version":3,"file":"page-DtEAx025.js","sources":["../../src/pages/dashboard/after-loan/asset-soundness-bad-debt/bad-debt-management/page.tsx"],"sourcesContent":["\n\nimport { usePathname } from \"@/lib/hooks/useAppLocation\";\nimport { useCallback, useEffect } from \"react\";\nimport { usePageStore } from \"@/lib/store/pageStore\";\nimport { listenForPopupMessages } from \"@/lib/popup-bus\";\nimport {\n  Breadcrumb,\n  BreadcrumbItem,\n  BreadcrumbList,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n} from \"@/components/ui/breadcrumb\";\nimport { LeftActions } from \"@/components/app/LeftActions\";\nimport { RightActions } from \"@/components/app/RightActions\";\nimport { DataTable } from \"@/components/app/DataTable\";\nimport { FilterContainer } from \"@/components/filters/FilterContainer\";\nimport type { FilterLayout } from \"@/components/filters/types\";\nimport TitleIcon from \"@/assets/icons/webp/title-icon.webp\";\nimport { ColumnDef } from \"@tanstack/react-table\";\nimport { toast } from \"sonner\";\n\n// Data type for the table\ntype BadDebtManagementData = {\n  id: number;\n  isRegistered: string;\n  writeOffType: string;\n  selectionDate: string;\n  accountName: string;\n  customerName: string;\n  customerNumber: string;\n  loanAccount: string;\n};\n\n// Mock data for the table\nconst mockData: BadDebtManagementData[] = Array.from({ length: 10 }, (_, i) => ({\n  id: i + 1,\n  isRegistered: i % 2 === 0 ? \"Y\" : \"N\",\n  writeOffType: `구분${(i % 3) + 1}`,\n  selectionDate: `2023-10-${String(10 + i).padStart(2, \"0\")}`,\n  accountName: \"일반자금대출\",\n  customerName: `고객${i + 1}`,\n  customerNumber: `CUST${3001 + i}`,\n  loanAccount: `ACC${4001 + i}`,\n}));\n\n// Column definitions for the table\nconst columns: ColumnDef<BadDebtManagementData>[] = [\n  { accessorKey: \"id\", header: \"순번\" },\n  { accessorKey: \"isRegistered\", header: \"등록여부\" },\n  { accessorKey: \"writeOffType\", header: \"상각구분\" },\n  { accessorKey: \"selectionDate\", header: \"선정일자\" },\n  { accessorKey: \"accountName\", header: \"과목명\" },\n  { accessorKey: \"customerName\", header: \"고객명\" },\n  { accessorKey: \"customerNumber\", header: \"고객번호\" },\n  { accessorKey: \"loanAccount\", header: \"여신계좌\" },\n];\n\nexport default function BadDebtManagementPage() {\n  const tabId = usePathname();\n  const { currentState, updateFilters, updateTableData, clearState } = usePageStore();\n\n  useEffect(() => {\n    const cleanup = listenForPopupMessages((message) => {\n      if (message.targetTabId !== tabId) return;\n\n      if (message.source === 'customer-search') {\n        const customer = message.payload;\n        updateFilters(tabId, { \n          customerNumber: customer.centralCustomerNumber,\n          accountNumber: customer.realNameNumber \n        });\n      } else if (message.source === 'branch-management') {\n        const branch = message.payload;\n        updateFilters(tabId, { \n          managementBranch: { \n            code: branch.branchName,\n            name: branch.branchCode\n          } \n        });\n      }\n    });\n    return cleanup;\n  }, [tabId, updateFilters]);\n\n  const filterLayout: FilterLayout = [\n    {\n      type: \"grid\",\n      columns: 3,\n      filters: [\n        { name: \"quarter\", type: \"select\", label: \"분기\", options: [{value: 'q1', label: '1분기'}] },\n        { \n          name: \"customerNumber\", \n          type: \"long-search\", \n          label: \"고객번호\",\n          defaultValue: \"CUST3001\",\n          readonly: true,\n          onButtonClick: (value?: any, e?: React.MouseEvent<HTMLElement>) => {\n            e?.preventDefault();\n            e?.stopPropagation();\n            const customerNumber = value || '';\n            const accountNumber = currentState?.filters.accountNumber || '';\n            window.open(`/popup/customer-search?customerNumber=${customerNumber}&accountNumber=${accountNumber}&openerTabId=${tabId}`, 'CustomerSearch', 'width=1600,height=800');\n          }\n        },\n        { name: \"accountNumber\", type: \"text\", label: \"계좌번호\" },\n        { \n          name: \"managementBranch\", \n          type: \"search\", \n          label: \"관리부점\",\n          readonly: true,\n          defaultValue: { code: \"B100\", name: \"강남1지점\" },\n          onButtonClick: (value?: any, e?: React.MouseEvent<HTMLElement>) => {\n            e?.preventDefault();\n            e?.stopPropagation();\n            const branchCode = value?.code || '';\n            const branchName = value?.name || '';\n            window.open(`/popup/branch-management?branchCode=${branchCode}&branchName=${branchName}&openerTabId=${tabId}`, 'BranchManagement', 'width=1600,height=800');\n          }\n        },\n        { name: \"isRegistered\", type: \"select\", label: \"등록여부\", options: [{value: 'y', label: 'Y'}, {value: 'n', label: 'N'}] },\n        { name: \"writeOffType\", type: \"select\", label: \"상각구분\", options: [{value: 'type1', label: '구분1'}] },\n      ],\n    },\n  ];\n\n  const handleFilterChange = useCallback(\n    (name: string, value: any) => {\n      updateFilters(tabId, { [name]: value });\n    },\n    [tabId, updateFilters]\n  );\n\n  const handleSearch = () => {\n    console.log(\"Search clicked, fetching data...\");\n    updateTableData(tabId, \"badDebtTable\", mockData);\n  };\n\n  if (!currentState) return null;\n\n  return (\n    <div className=\"flex flex-col gap-3\">\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex items-center gap-2\">\n          <img src={TitleIcon} alt=\"타이틀 아이콘\" width={40} height={40} />\n          <h2 className=\"text-lg font-semibold\">대손상각대상 관리</h2>\n        </div>\n        <Breadcrumb>\n          <BreadcrumbList>\n            <BreadcrumbItem>홈</BreadcrumbItem>\n            <BreadcrumbSeparator />\n            <BreadcrumbItem>여신사후</BreadcrumbItem>\n            <BreadcrumbSeparator />\n            <BreadcrumbItem>재산건전성/대손상각</BreadcrumbItem>\n            <BreadcrumbSeparator />\n            <BreadcrumbItem>\n              <BreadcrumbPage>대손상각대상 관리</BreadcrumbPage>\n            </BreadcrumbItem>\n          </BreadcrumbList>\n        </Breadcrumb>\n      </div>\n\n      <div className=\"flex justify-between\">\n        <LeftActions actions={[{ id: \"terminate\" }]} />\n        <RightActions\n          actions={[\n            { id: \"excel\" },\n            { id: \"register\" },\n            { id: \"search\", onClick: handleSearch },\n            { id: \"data-reset\", onClick: () => clearState(tabId) },\n            { id: \"reset\" },\n          ]}\n        />\n      </div>\n\n      <FilterContainer\n        filterLayout={filterLayout}\n        values={currentState.filters}\n        onChange={handleFilterChange}\n      />\n\n      <DataTable\n        title=\"조회내용\"\n        columns={columns}\n        data={currentState.tables?.['badDebtTable'] || []}\n        amountColumns={[\"provisionalPayment\", \"loanBalance\"]}\n        dateColumnConfig={{ selectionDate: \"YYYYMMDD\" }}\n      />\n    </div>\n  );\n}\n"],"names":["mockData","_","i","columns","BadDebtManagementPage","tabId","usePathname","currentState","updateFilters","updateTableData","clearState","usePageStore","useEffect","listenForPopupMessages","message","customer","branch","filterLayout","value","customerNumber","accountNumber","branchCode","branchName","handleFilterChange","useCallback","name","handleSearch","jsxs","jsx","TitleIcon","Breadcrumb","BreadcrumbList","BreadcrumbItem","BreadcrumbSeparator","BreadcrumbPage","LeftActions","RightActions","FilterContainer","DataTable","_a"],"mappings":"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"}