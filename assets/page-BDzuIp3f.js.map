{"version":3,"file":"page-BDzuIp3f.js","sources":["../../src/pages/dashboard/after-loan/bond-adjustment/bankruptcy-exemption/page.tsx"],"sourcesContent":["\n\nimport { usePathname } from \"@/lib/hooks/useAppLocation\";\nimport { useCallback, useEffect } from \"react\";\nimport { usePageStore } from \"@/lib/store/pageStore\";\nimport { listenForPopupMessages } from \"@/lib/popup-bus\";\nimport {\n  Breadcrumb,\n  BreadcrumbItem,\n  BreadcrumbList,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n} from \"@/components/ui/breadcrumb\";\nimport { LeftActions } from \"@/components/app/LeftActions\";\nimport { RightActions } from \"@/components/app/RightActions\";\nimport { DataTable } from \"@/components/app/DataTable\";\nimport { FilterContainer } from \"@/components/filters/FilterContainer\";\nimport type { FilterLayout } from \"@/components/filters/types\";\nimport TitleIcon from \"@/assets/icons/webp/title-icon.webp\";\nimport { ColumnDef } from \"@tanstack/react-table\";\n\n// Data type for the table\ntype BankruptcyBankData = {\n  id: number;\n  acntNo: string;\n  applicantNm: string;\n  acntSttsCd: string;\n  prdctNm: string;\n  nwDt: string;\n  expDt: string;\n  loanAmt: number;\n};\n\n// 예시 데이터\nconst mockData: BankruptcyBankData[] = [\n  {\n    id: 1,\n    acntNo: \"123-456-7890\",\n    applicantNm: \"홍길동\",\n    acntSttsCd: \"정상\",\n    prdctNm: \"신용대출\",\n    nwDt: \"20230101\",\n    expDt: \"20240101\",\n    loanAmt: 10000000,\n  },\n  {\n    id: 2,\n    acntNo: \"987-654-3210\",\n    applicantNm: \"김철수\",\n    acntSttsCd: \"연체\",\n    prdctNm: \"담보대출\",\n    nwDt: \"20220515\",\n    expDt: \"20250515\",\n    loanAmt: 50000000,\n  },\n];\n\n// Column definitions for the table\nconst columns: ColumnDef<BankruptcyBankData>[] = [\n  { accessorKey: \"id\", header: \"순번\" },\n  { accessorKey: \"acntNo\", header: \"계좌번호\" },\n  { accessorKey: \"applicantNm\", header: \"신청인명\" },\n  { accessorKey: \"acntSttsCd\", header: \"계좌상태\" },\n  { accessorKey: \"prdctNm\", header: \"상품명\" },\n  { accessorKey: \"nwDt\", header: \"대출신규일자\" },\n  { accessorKey: \"expDt\", header: \"대출만기일자\" },\n  { accessorKey: \"loanAmt\", header: \"대출금액\" },\n];\n\nexport default function BankruptcyExemptionPage() {\n  const tabId = usePathname();\n  const { currentState, updateFilters, clearState } = usePageStore();\n\n  useEffect(() => {\n    const cleanup = listenForPopupMessages((message) => {\n      if (message.targetTabId !== tabId) return;\n      \n      if (message.source === 'customer-search') {\n        const customer = message.payload;\n        const sourceFilter = customer.sourceFilter;\n\n        // Handle customer search results\n        if (sourceFilter === 'customerNumber') {\n          updateFilters(tabId, { customerNumber: customer.centralCustomerNumber });\n        } else if (sourceFilter === 'applicantName') {\n          // Assuming applicant search returns similar structure or we map it\n          updateFilters(tabId, { applicantName: customer.customerName }); \n        }\n      } else if (message.source === 'modification-history') {\n        const historyData = message.payload;\n        updateFilters(tabId, {\n          topAccountNumber: historyData.accountNumber,\n          topCustomerNumber: historyData.customerNumber,\n        });\n      }\n    });\n    return cleanup;\n  }, [tabId, updateFilters]);\n\n  // Top filter layout (Read-only info + Type select)\n  const topFilterLayout: FilterLayout = [\n    {\n      type: \"grid\",\n      columns: 3, // Adjust columns as needed for layout\n      filters: [\n        {\n          name: \"topCustomerNumber\",\n          type: \"text\",\n          label: \"고객번호\",\n          readonly: true,\n        },\n        {\n          name: \"topAccountNumber\",\n          type: \"text\",\n          label: \"계좌번호\",\n          readonly: true,\n        },\n        {\n          name: \"bondAdjustmentType\",\n          type: \"select\",\n          label: \"채권조정구분\",\n          options: [{ value: \"bankruptcy-exemption\", label: \"파산/면책\" }],\n          defaultValue: \"bankruptcy-exemption\",\n          readonly: true,\n        },\n      ],\n    },\n  ];\n\n  // Detailed filter layout for \"Bankruptcy/Exemption Ledger Info\"\n  const bankruptcyFilterLayout: FilterLayout = [\n    {\n      type: \"grid\",\n      columns: 4,\n      filters: [\n        { \n          name: \"customerNumber\", \n          type: \"long-search\", \n          label: \"고객번호\",\n          onButtonClick: (value?: any, e?: React.MouseEvent<HTMLElement>) => {\n            e?.preventDefault();\n            e?.stopPropagation();\n            const customerNumber = value || '';\n            // openerTabId removed to prevent data feedback (double click disabled in popup context effectively)\n            window.open(`/popup/customer-search?customerNumber=${customerNumber}&sourceFilter=customerNumber`, 'CustomerSearch', 'width=1600,height=800');\n          }\n        },\n        { name: \"debtorName\", type: \"text\", label: \"채무자명\", readonly: true },\n        { \n          name: \"applicantName\", \n          type: \"long-search\", \n          label: \"신청자명\",\n          readonly: true,\n          onButtonClick: (value?: any, e?: React.MouseEvent<HTMLElement>) => {\n            e?.preventDefault();\n            e?.stopPropagation();\n            const name = value || '';\n             // openerTabId removed\n            window.open(`/popup/customer-search?customerName=${name}&sourceFilter=applicantName`, 'CustomerSearch', 'width=1600,height=800');\n          }\n        },\n        { name: \"residentRegistrationNumber\", type: \"text\", label: \"주민등록번호\", readonly: true },\n        \n        { name: \"accountNumber\", type: \"text\", label: \"계좌번호\", readonly: true },\n        { name: \"loanBalance\", type: \"number\", label: \"대출잔액\", readonly: true },\n        { name: \"handlingBank\", type: \"text\", label: \"취급은행\" },\n        { name: \"blank_1\", type: \"blank\" },\n\n        { name: \"balanceStandardMonth\", type: \"date\", label: \"잔액기준년월\" },\n        { name: \"standardBalanceAmount\", type: \"number\", label: \"기준잔액금액\" },\n        { name: \"blank_2\", type: \"blank\" },\n        { name: \"blank_3\", type: \"blank\" },\n\n        { \n          name: \"competentCourt\", \n          type: \"select\", \n          label: \"관할법원\",\n          options: [{ value: \"gapyeong\", label: \"[26] 가평군법원\" }, { value: \"seoul\", label: \"[01] 서울중앙지법\" }] \n        },\n        { \n          name: \"progressStatus\", \n          type: \"select\", \n          label: \"진행상태\",\n          options: [{ value: \"receipt\", label: \"접수\" }, { value: \"ongoing\", label: \"진행중\" }, { value: \"completed\", label: \"완료\" }]\n        },\n        { name: \"caseNumberBottom\", type: \"text\", label: \"사건번호(하단)\" },\n        { name: \"caseNumberScreen\", type: \"text\", label: \"사건번호(화면)\" },\n\n        { name: \"receiptDate\", type: \"date\", label: \"접수일자\" },\n        { name: \"sentencingDate\", type: \"date\", label: \"선고일자\" },\n        { name: \"exemptionDate\", type: \"date\", label: \"면책일\" },\n        { name: \"revocationDate\", type: \"date\", label: \"폐지일자\" },\n\n        { name: \"notes\", type: \"text\", label: \"특이사항\", colSpan: 4 },\n      ],\n    },\n  ];\n\n  const handleFilterChange = useCallback(\n    (name: string, value: any) => {\n      updateFilters(tabId, { [name]: value });\n    },\n    [tabId, updateFilters]\n  );\n\n  const handleRowClick = (row: BankruptcyBankData) => {\n    // Mock population of detail fields on row click\n    const mockDetailData = {\n      customerNumber: \"00012345678\",\n      debtorName: row.applicantNm,\n      applicantName: row.applicantNm,\n      residentRegistrationNumber: \"800101-1234567\",\n      accountNumber: row.acntNo,\n      loanBalance: row.loanAmt,\n      handlingBank: \"친애저축은행\",\n      balanceStandardMonth: \"2024-01-01\",\n      standardBalanceAmount: row.loanAmt,\n      competentCourt: \"seoul\",\n      progressStatus: \"ongoing\",\n      caseNumberBottom: \"2023개회12345\",\n      caseNumberScreen: \"2023-12345\",\n      receiptDate: \"2023-05-01\",\n      sentencingDate: \"2023-06-01\",\n      exemptionDate: \"2024-05-01\",\n      revocationDate: \"\",\n      notes: \"특이사항 없음\",\n      // Also update top read-only fields\n      topCustomerNumber: \"00012345678\",\n      topAccountNumber: row.acntNo,\n    };\n    updateFilters(tabId, mockDetailData);\n  };\n\n  const handleActionClick = (action: string) => () => {\n    console.log(`${action} clicked`);\n  };\n\n  // Assuming LeftActions handles 'modification-history' internally if logic is simple, or we pass handler\n  const handleLeftActionClick = () => {\n    const { customerNumber, accountNumber } = currentState?.filters || {};\n\n    window.open(\n      `/popup/modification-history?customerNumber=${customerNumber || ''}&accountNumber=${accountNumber || ''}&openerTabId=${tabId}`,\n      'ModificationHistory',\n      'width=1600,height=800'\n    );\n  };\n\n  if (!currentState) return null;\n\n  return (\n    <div className=\"flex flex-col gap-3\">\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex items-center gap-2\">\n          <img src={TitleIcon} alt=\"타이틀 아이콘\" width={40} height={40} />\n          <h2 className=\"text-lg font-semibold\">파산면책관리</h2>\n        </div>\n        <Breadcrumb>\n          <BreadcrumbList>\n            <BreadcrumbItem>홈</BreadcrumbItem>\n            <BreadcrumbSeparator />\n            <BreadcrumbItem>여신사후</BreadcrumbItem>\n            <BreadcrumbSeparator />\n            <BreadcrumbItem>채권조정</BreadcrumbItem>\n            <BreadcrumbSeparator />\n            <BreadcrumbItem>\n              <BreadcrumbPage>파산면책관리</BreadcrumbPage>\n            </BreadcrumbItem>\n          </BreadcrumbList>\n        </Breadcrumb>\n      </div>\n\n      <div className=\"flex items-center justify-between\">\n        <LeftActions \n          actions={[\n            { id: \"modification-history\", onClick: handleLeftActionClick }\n          ]} \n        />\n        <RightActions\n          actions={[\n            { id: \"searchDoc\" },\n            { id: \"scan\" },\n            { id: \"new\" },\n            { id: \"register\" },\n            { id: \"search\" },\n            { id: \"data-reset\", onClick: () => clearState(tabId) },\n          ]}\n        />\n      </div>\n\n      <FilterContainer \n        filterLayout={topFilterLayout} \n        values={currentState.filters}\n        onChange={handleFilterChange}\n      />\n\n      <DataTable\n        title=\"당행\"\n        columns={columns}\n        data={mockData}\n        amountColumns={[\"loanAmt\"]}\n        dateColumnConfig={{ nwDt: \"YYYYMMDD\", expDt: \"YYYYMMDD\" }}\n        onRowClick={handleRowClick}\n      />\n\n      <div className=\"flex flex-col gap-4\">\n        <h3 className=\"font-semibold\">파산면책 원장정보</h3>\n        <FilterContainer \n          filterLayout={bankruptcyFilterLayout} \n          values={currentState.filters}\n          onChange={handleFilterChange}\n        />\n      </div>\n    </div>\n  );\n}\n"],"names":["mockData","columns","BankruptcyExemptionPage","tabId","usePathname","currentState","updateFilters","clearState","usePageStore","useEffect","listenForPopupMessages","message","customer","sourceFilter","historyData","topFilterLayout","bankruptcyFilterLayout","value","customerNumber","name","handleFilterChange","useCallback","handleRowClick","row","mockDetailData","handleLeftActionClick","accountNumber","jsxs","jsx","TitleIcon","Breadcrumb","BreadcrumbList","BreadcrumbItem","BreadcrumbSeparator","BreadcrumbPage","LeftActions","RightActions","FilterContainer","DataTable"],"mappings":"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"}