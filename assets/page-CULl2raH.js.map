{"version":3,"file":"page-CULl2raH.js","sources":["../../src/pages/dashboard/after-loan/special-bond/subscription-inquiry/page.tsx"],"sourcesContent":["\n\nimport { useState, useEffect, useCallback, useMemo } from \"react\";\nimport { usePathname } from \"@/lib/hooks/useAppLocation\";\nimport {\n  Breadcrumb,\n  BreadcrumbItem,\n  BreadcrumbList,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n} from \"@/components/ui/breadcrumb\";\nimport TitleIcon from \"@/assets/icons/webp/title-icon.webp\";\nimport { ColumnDef } from \"@tanstack/react-table\";\nimport { DataTable } from \"@/components/app/DataTable\";\nimport { FilterContainer } from \"@/components/filters/FilterContainer\";\nimport { RightActions } from \"@/components/app/RightActions\";\nimport type { FilterLayout } from \"@/components/filters/types\";\nimport { usePageStore } from \"@/lib/store/pageStore\";\nimport { listenForPopupMessages } from \"@/lib/popup-bus\";\n\n// --- Types ---\n\ninterface SpecialBondSubscriptionData {\n  id: number; // 순번 (implicit)\n  usrNm: string; // 담당자명\n  incrprDt: string; // 편입일자\n  custNo: string; // 고객번호\n  custNm: string; // 고객명\n  acntNo: string; // 계좌번호\n  accCd: string; // 상품명\n  loanDt: string; // 대출일자\n  expDt: string; // 만기일자\n  loanAmt: number; // 대출금액\n  incrprAmt: number; // 편입금액\n  incrprNrmlIntr: number; // 편입정상이자\n  incrprArrs: number; // 편입연체료\n  incrprArrintr: number; // 편입연체이자\n  incrprSpnpyt: number; // 편입가지급금\n  loanBlce: number; // 대출잔액\n  acitrc: number; // 미수이자\n  ouArrs: number; // 미수연체료\n  ouArrIntr: number; // 미수연체이자\n  ouSpnpyt: number; // 미수가지급금\n}\n\n// --- Mock Data ---\nconst mockData: SpecialBondSubscriptionData[] = Array.from({ length: 20 }, (_, i) => ({\n  id: i + 1,\n  usrNm: `담당자${i + 1}`,\n  incrprDt: \"2024-11-01\",\n  custNo: `CUST${1000 + i}`,\n  custNm: `고객${i + 1}`,\n  acntNo: `100-200-${300000 + i}`,\n  accCd: \"신용대출\",\n  loanDt: \"2023-01-01\",\n  expDt: \"2025-01-01\",\n  loanAmt: 10000000 * (i + 1),\n  incrprAmt: 9000000 * (i + 1),\n  incrprNrmlIntr: 100000,\n  incrprArrs: 50000,\n  incrprArrintr: 20000,\n  incrprSpnpyt: 10000,\n  loanBlce: 8500000 * (i + 1),\n  acitrc: 5000,\n  ouArrs: 2000,\n  ouArrIntr: 1000,\n  ouSpnpyt: 0,\n}));\n\n// --- Columns ---\nconst columns: ColumnDef<SpecialBondSubscriptionData>[] = [\n  { accessorKey: \"id\", header: \"순번\" },\n  { accessorKey: \"usrNm\", header: \"담당자명\" },\n  { accessorKey: \"incrprDt\", header: \"편입일자\" },\n  { accessorKey: \"custNo\", header: \"고객번호\" },\n  { accessorKey: \"custNm\", header: \"고객명\" },\n  { accessorKey: \"acntNo\", header: \"계좌번호\" },\n  { accessorKey: \"accCd\", header: \"상품명\" },\n  { accessorKey: \"loanDt\", header: \"대출일자\" },\n  { accessorKey: \"expDt\", header: \"만기일자\" },\n  { accessorKey: \"loanAmt\", header: \"대출금액\" },\n  { accessorKey: \"incrprAmt\", header: \"편입금액\" },\n  { accessorKey: \"incrprNrmlIntr\", header: \"편입정상이자\" },\n  { accessorKey: \"incrprArrs\", header: \"편입연체료\" },\n  { accessorKey: \"incrprArrintr\", header: \"편입연체이자\" },\n  { accessorKey: \"incrprSpnpyt\", header: \"편입가지급금\" },\n  { accessorKey: \"loanBlce\", header: \"대출잔액\" },\n  { accessorKey: \"acitrc\", header: \"미수이자\" },\n  { accessorKey: \"ouArrs\", header: \"미수연체료\" },\n  { accessorKey: \"ouArrIntr\", header: \"미수연체이자\" },\n  { accessorKey: \"ouSpnpyt\", header: \"미수가지급금\" },\n];\n\nexport default function SpecialBondSubscriptionInquiryPage() {\n  const tabId = usePathname();\n  const { currentState, loadState, updateFilters, updateTableData, clearState } = usePageStore();\n  const [filters, setFilters] = useState<Record<string, any>>(currentState?.filters || {});\n\n  const tableData = useMemo(() => \n    currentState?.tables?.['subscriptionInquiryTable'] || [], \n    [currentState?.tables]\n  );\n\n  useEffect(() => {\n    if (!currentState?.tables?.['subscriptionInquiryTable']) {\n      updateTableData(tabId, 'subscriptionInquiryTable', mockData);\n    }\n  }, [tabId, currentState?.tables, updateTableData]);\n\n  useEffect(() => {\n    loadState(tabId);\n  }, [tabId, loadState]);\n\n  useEffect(() => {\n    const cleanup = listenForPopupMessages((message) => {\n      if (message.targetTabId !== tabId) return;\n\n      if (message.source === \"customer-search\") {\n        const customer = message.payload;\n        handleFilterChange(\"customer\", customer.customerName);\n      } else if (message.source === \"branch-management\") {\n        const branch = message.payload;\n        handleFilterChange(\"managementBranch\", { code: branch.branchCode, name: branch.branchName });\n      }\n    });\n    return cleanup;\n  }, [tabId]);\n\n  const handleFilterChange = useCallback((name: string, value: any) => {\n    setFilters((prev) => {\n      const newFilters = { ...prev, [name]: value };\n      return newFilters;\n    });\n  }, []);\n\n  useEffect(() => {\n    updateFilters(tabId, filters);\n  }, [tabId, filters, updateFilters]);\n\n  const filterLayout: FilterLayout = useMemo(() => [\n    {\n      type: \"grid\",\n      columns: 2,\n      filters: [\n        {\n          name: \"incorporationDate\",\n          type: \"date-range\",\n          label: \"편입일자\",\n        },\n        {\n          name: \"managementBranch\",\n          type: \"search\",\n          label: \"관리부점\",\n          readonly: true,\n          onButtonClick: (value, e) => {\n            e?.preventDefault();\n            window.open(\n              `/popup/branch-management?openerTabId=${tabId}`,\n              \"BranchManagement\",\n              \"width=1600,height=800\"\n            );\n          },\n        },\n        {\n          name: \"customer\",\n          type: \"long-search\",\n          label: \"고객번호\",\n          readonly: true,\n          onButtonClick: (value, e) => {\n            e?.preventDefault();\n            window.open(\n              `/popup/customer-search?openerTabId=${tabId}`,\n              \"CustomerSearch\",\n              \"width=1600,height=800\"\n            );\n          },\n        },\n        {\n          name: \"accountNumber\",\n          type: \"text\",\n          label: \"계좌번호\",\n        },\n      ],\n    },\n  ], [tabId]);\n\n  const handleSearch = () => {\n    console.log(\"Searching with filters:\", filters);\n    updateTableData(tabId, 'subscriptionInquiryTable', mockData);\n  };\n\n  const handleExcelDownload = () => {\n    alert(\"엑셀 다운로드 실행\");\n  };\n\n  const handleReset = () => {\n    setFilters({});\n    clearState(tabId);\n  };\n\n  if (!currentState) return null;\n\n  const amountColumns = [\n    \"loanAmt\", \"incrprAmt\", \"incrprNrmlIntr\", \"incrprArrs\", \"incrprArrintr\", \n    \"incrprSpnpyt\", \"loanBlce\", \"acitrc\", \"ouArrs\", \"ouArrIntr\", \"ouSpnpyt\"\n  ];\n\n  return (\n    <div className=\"flex flex-col gap-3\">\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex items-center gap-2\">\n          <img src={TitleIcon} alt=\"타이틀 아이콘\" width={40} height={40} />\n          <h2 className=\"text-lg font-semibold\">특수채권 편입조회</h2>\n        </div>\n        <Breadcrumb>\n          <BreadcrumbList>\n            <BreadcrumbItem>홈</BreadcrumbItem>\n            <BreadcrumbSeparator />\n            <BreadcrumbItem>여신사후</BreadcrumbItem>\n            <BreadcrumbSeparator />\n            <BreadcrumbItem>특수채권</BreadcrumbItem>\n            <BreadcrumbSeparator />\n            <BreadcrumbItem>\n              <BreadcrumbPage>특수채권 편입조회</BreadcrumbPage>\n            </BreadcrumbItem>\n          </BreadcrumbList>\n        </Breadcrumb>\n      </div>\n\n      <div className=\"flex justify-end\">\n        <RightActions\n          actions={[\n            { id: \"search\", onClick: handleSearch },\n            { id: \"excel\", onClick: handleExcelDownload },\n            { id: \"data-reset\", onClick: handleReset },\n          ]}\n        />\n      </div>\n\n      <div className=\"flex flex-col gap-4\">\n        <h3 className=\"font-semibold\">검색 조건</h3>\n        <FilterContainer\n          filterLayout={filterLayout}\n          values={filters}\n          onChange={handleFilterChange}\n        />\n      </div>\n\n      <DataTable\n        title=\"특수채권 편입내역\"\n        columns={columns}\n        data={tableData}\n        amountColumns={amountColumns}\n        minWidth=\"1820px\"\n      />\n    </div>\n  );\n}\n"],"names":["mockData","_","i","columns","SpecialBondSubscriptionInquiryPage","tabId","usePathname","currentState","loadState","updateFilters","updateTableData","clearState","usePageStore","filters","setFilters","useState","tableData","useMemo","_a","useEffect","listenForPopupMessages","message","customer","handleFilterChange","branch","useCallback","name","value","prev","filterLayout","e","handleSearch","handleExcelDownload","handleReset","amountColumns","jsxs","jsx","TitleIcon","Breadcrumb","BreadcrumbList","BreadcrumbItem","BreadcrumbSeparator","BreadcrumbPage","RightActions","FilterContainer","DataTable"],"mappings":"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"}