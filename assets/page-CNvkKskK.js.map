{"version":3,"file":"page-CNvkKskK.js","sources":["../../src/pages/popup/soundness-audit-opinion/page.tsx"],"sourcesContent":["\n\nimport { useState, useCallback, Suspense, useMemo, useEffect } from \"react\";\nimport { useSearchParams } from \"@/lib/hooks/useAppLocation\";\nimport { Button } from \"@/components/ui/button\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport { cn } from \"@/lib/utils\";\nimport { PopupRightActions, PopupAction } from \"@/components/app/PopupRightActions\";\n\n// Mock data type\ntype AuditOpinion = {\n  id: number;\n  opinion: string;\n  registrant: string;\n};\n\n// Mock data\nconst mockOpinions: AuditOpinion[] = [\n  { id: 1, opinion: \"건전성 지표가 양호합니다.\", registrant: \"홍길동\" },\n  { id: 2, opinion: \"특이사항 없습니다.\", registrant: \"이순신\" },\n];\n\nfunction SoundnessAuditOpinionContent() {\n  const searchParams = useSearchParams();\n  const openerTabId = searchParams.get(\"openerTabId\");\n  const initialSelectedMonth = searchParams.get(\"selectedMonth\") || \"202401\";\n  const monthOptionsParam = searchParams.get(\"monthOptions\");\n\n  const [settlementMonth, setSettlementMonth] = useState(initialSelectedMonth);\n  const [monthOptions, setMonthOptions] = useState<{value: string, label: string}[]>([]);\n  const [opinionText, setOpinionText] = useState(\"\");\n  const [opinions, setOpinions] = useState<AuditOpinion[]>(mockOpinions);\n  const [selectedIds, setSelectedIds] = useState<number[]>([]);\n\n  useEffect(() => {\n    if (monthOptionsParam) {\n      try {\n        const parsedOptions = JSON.parse(decodeURIComponent(monthOptionsParam));\n        setMonthOptions(parsedOptions);\n      } catch (e) {\n        console.error(\"Failed to parse month options:\", e);\n      }\n    }\n  }, [monthOptionsParam]);\n\n  const handleRegister = useCallback(() => {\n    if (!opinionText.trim()) return;\n\n    const newOpinion: AuditOpinion = {\n      id: Math.max(0, ...opinions.map((o) => o.id)) + 1,\n      opinion: opinionText,\n      registrant: \"관리자\", // In a real app, this would be the logged-in user\n    };\n\n    setOpinions((prev) => [...prev, newOpinion]);\n    setOpinionText(\"\");\n  }, [opinionText, opinions]);\n\n  const handleDelete = useCallback(() => {\n    setOpinions((prev) => prev.filter((o) => !selectedIds.includes(o.id)));\n    setSelectedIds([]);\n  }, [selectedIds]);\n\n  const toggleSelect = (id: number) => {\n    setSelectedIds((prev) =>\n      prev.includes(id) ? prev.filter((i) => i !== id) : [...prev, id]\n    );\n  };\n\n  const toggleSelectAll = (checked: boolean) => {\n    if (checked) {\n      setSelectedIds(opinions.map((o) => o.id));\n    } else {\n      setSelectedIds([]);\n    }\n  };\n\n  const handleRowDoubleClick = (opinion: string) => {\n    setOpinionText(opinion);\n  };\n\n  const rightActions: PopupAction[] = useMemo(() => [\n    {\n      id: \"register\",\n      text: \"등록/수정\",\n      onClick: handleRegister,\n    },\n    {\n      id: \"delete\",\n      text: \"삭제\",\n      onClick: handleDelete,\n    },\n  ], [handleRegister, handleDelete]);\n\n  return (\n    <div className=\"flex flex-col h-full bg-background p-6 gap-4\">\n      <div className=\"flex justify-between items-center\">\n        <h2 className=\"text-xl font-semibold\">건전성자료 감리의견</h2>\n        <PopupRightActions actions={rightActions} />\n      </div>\n\n      <div className=\"flex items-center gap-2 border-t pt-4\">\n        <span className=\"text-sm font-medium\">결산월:</span>\n        <Select value={settlementMonth} onValueChange={setSettlementMonth}>\n          <SelectTrigger className=\"w-[120px]\">\n            <SelectValue placeholder=\"선택\" />\n          </SelectTrigger>\n          <SelectContent>\n            {monthOptions.length > 0 ? (\n              monthOptions.map((option) => (\n                <SelectItem key={option.value} value={option.value}>\n                  {option.label}\n                </SelectItem>\n              ))\n            ) : (\n              // Fallback options if no data is passed\n              <>\n                <SelectItem value=\"202401\">202401</SelectItem>\n                <SelectItem value=\"202402\">202402</SelectItem>\n                <SelectItem value=\"202403\">202403</SelectItem>\n              </>\n            )}\n          </SelectContent>\n        </Select>\n      </div>\n\n      <div className=\"flex flex-col gap-2 flex-grow\">\n        <Textarea\n          placeholder=\"의견 또는 결과를 입력하세요\"\n          className=\"resize-none h-32\"\n          value={opinionText}\n          onChange={(e) => setOpinionText(e.target.value)}\n        />\n\n        <div className=\"flex-grow rounded-md border overflow-hidden\">\n          <Table>\n            <TableHeader className=\"bg-muted/50 sticky top-0\">\n              <TableRow>\n                <TableHead className=\"w-[50px] text-center p-0 border-r last:border-r-0\">\n                  <div className=\"flex justify-center items-center w-full h-full\">\n                    <Checkbox\n                      checked={\n                        opinions.length > 0 &&\n                        selectedIds.length === opinions.length\n                      }\n                      onCheckedChange={toggleSelectAll}\n                    />\n                  </div>\n                </TableHead><TableHead className=\"w-[60px] text-center border-r last:border-r-0\">순번</TableHead><TableHead className=\"border-r last:border-r-0\">감리의견</TableHead><TableHead className=\"w-[100px] text-center border-r last:border-r-0\">등록자</TableHead>\n              </TableRow>\n            </TableHeader>\n            <TableBody>\n              {opinions.length > 0 ? (\n                opinions.map((row, index) => (\n                  <TableRow \n                    key={row.id}\n                    onDoubleClick={() => handleRowDoubleClick(row.opinion)}\n                    className=\"cursor-pointer hover:bg-muted/50\"\n                  >\n                    <TableCell className=\"text-center p-0 border-r last:border-r-0\">\n                        <div className=\"flex justify-center items-center w-full h-full\">\n                          <Checkbox\n                            checked={selectedIds.includes(row.id)}\n                            onCheckedChange={() => toggleSelect(row.id)}\n                            onClick={(e) => e.stopPropagation()} \n                          />\n                        </div>\n                    </TableCell><TableCell className=\"text-center border-r last:border-r-0\">{index + 1}</TableCell><TableCell className=\"border-r last:border-r-0\">{row.opinion}</TableCell><TableCell className=\"text-center border-r last:border-r-0\">\n                      {row.registrant}\n                    </TableCell>\n                  </TableRow>\n                ))\n              ) : (\n                <TableRow>\n                  <TableCell colSpan={4} className=\"text-center h-24 border-r last:border-r-0\">\n                    데이터가 없습니다.\n                  </TableCell>\n                </TableRow>\n              )}\n            </TableBody>\n          </Table>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default function SoundnessAuditOpinionPopup() {\n  return (\n    <Suspense fallback={<div>Loading...</div>}>\n      <SoundnessAuditOpinionContent />\n    </Suspense>\n  );\n}"],"names":["mockOpinions","SoundnessAuditOpinionContent","searchParams","useSearchParams","initialSelectedMonth","monthOptionsParam","settlementMonth","setSettlementMonth","useState","monthOptions","setMonthOptions","opinionText","setOpinionText","opinions","setOpinions","selectedIds","setSelectedIds","useEffect","parsedOptions","e","handleRegister","useCallback","newOpinion","o","prev","handleDelete","toggleSelect","id","i","toggleSelectAll","checked","handleRowDoubleClick","opinion","rightActions","useMemo","jsxs","jsx","PopupRightActions","Select","SelectTrigger","SelectValue","SelectContent","option","SelectItem","Fragment","Textarea","Table","TableHeader","TableRow","TableHead","Checkbox","TableBody","row","index","TableCell","SoundnessAuditOpinionPopup","Suspense"],"mappings":"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"}