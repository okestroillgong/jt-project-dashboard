{"version":3,"file":"page-HCLiY2yf.js","sources":["../../src/pages/popup/unprocessed-amount-processing/page.tsx"],"sourcesContent":["\n\nimport { useCallback, useEffect, useState } from \"react\";\nimport { useSearchParams } from \"@/lib/hooks/useAppLocation\";\nimport { Button } from \"@/components/ui/button\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { DataTable } from \"@/components/app/DataTable\";\nimport { ColumnDef } from \"@tanstack/react-table\";\nimport { PopupRightActions, PopupAction } from \"@/components/app/PopupRightActions\";\nimport { FilterContainer } from \"@/components/filters/FilterContainer\";\nimport type { FilterLayout } from \"@/components/filters/types\";\n\n// --- Types ---\ntype UnprocessedTargetData = {\n  id: number;\n  curRow: number;\n  acntNo: string;\n  rasCustNm: string;\n  untAmt: number;\n  lastPrcsDt: string;\n};\n\ntype PaymentHistoryData = {\n  id: number;\n  pytRn: number;\n  pytAmt: number;\n  aclPytAmt: number;\n  prcsDt: string;\n};\n\n// --- Mock Data ---\nconst unprocessedTargetMockData: UnprocessedTargetData[] = Array.from({ length: 5 }, (_, i) => ({\n  id: i + 1,\n  curRow: i + 1,\n  acntNo: `123-456-789${i}`,\n  rasCustNm: `홍길동${i + 1}`,\n  untAmt: 50000 * (i + 1),\n  lastPrcsDt: \"2024-01-01\",\n}));\n\nconst paymentHistoryMockData: PaymentHistoryData[] = Array.from({ length: 5 }, (_, i) => ({\n  id: i + 1,\n  pytRn: i + 1,\n  pytAmt: 100000 * (i + 1),\n  aclPytAmt: 100000 * (i + 1),\n  prcsDt: \"2024-02-01\",\n}));\n\nexport default function UnprocessedAmountProcessingPopup() {\n  const searchParams = useSearchParams();\n  \n  const [unprocessedAmount, setUnprocessedAmount] = useState(\"\");\n  const [targetData, setTargetData] = useState<UnprocessedTargetData[]>([]);\n  const [historyData, setHistoryData] = useState<PaymentHistoryData[]>([]);\n  const [detailInfo, setDetailInfo] = useState({\n    applicationDate: \"\",\n    unprocessedAmountDetail: \"\",\n    unprocessedBalance: \"\",\n  });\n\n  useEffect(() => {\n    const amount = searchParams.get(\"unprocessedAmount\");\n    if (amount) {\n        setUnprocessedAmount(amount);\n    }\n  }, [searchParams]);\n\n  // Handlers\n  const handleApply = () => {\n    // 1. 조회(적용) 버튼 클릭 시 -> 미처리적용대상 데이터 채움 (Mock fetch)\n    setTargetData(unprocessedTargetMockData);\n  };\n\n  const handleSave = () => {\n    // 저장 로직 (Mock)\n    alert(\"저장되었습니다.\");\n  };\n\n  const handleTargetRowDoubleClick = (row: UnprocessedTargetData) => {\n    // 3. 미처리적용대상 로우 더블 클릭 -> 하단 상세 정보 및 납입내역 채움\n    setDetailInfo({\n        applicationDate: \"2024-01-01\",\n        unprocessedAmountDetail: row.untAmt.toLocaleString(),\n        unprocessedBalance: (row.untAmt * 5).toLocaleString(),\n    });\n    setHistoryData(paymentHistoryMockData);\n  };\n\n  const [selectedHistoryIds, setSelectedHistoryIds] = useState<Set<number>>(new Set());\n\n  const toggleHistorySelection = useCallback((id: number) => {\n    setSelectedHistoryIds((prev) => {\n      const newSet = new Set(prev);\n      if (newSet.has(id)) newSet.delete(id);\n      else newSet.add(id);\n      return newSet;\n    });\n  }, []);\n\n  const toggleAllHistory = useCallback((checked: boolean) => {\n    if (checked) {\n      setSelectedHistoryIds(new Set(historyData.map((d) => d.id)));\n    } else {\n      setSelectedHistoryIds(new Set());\n    }\n  }, [historyData]);\n\n  // --- Columns Definitions ---\n  const targetColumns: ColumnDef<UnprocessedTargetData>[] = [\n    { accessorKey: \"curRow\", header: \"순번\" },\n    { accessorKey: \"acntNo\", header: \"계좌번호\" },\n    { accessorKey: \"rasCustNm\", header: \"신청인\" },\n    { accessorKey: \"untAmt\", header: \"미처리금액\" },\n    { accessorKey: \"lastPrcsDt\", header: \"최종처리일자\" },\n  ];\n\n  const historyColumns: ColumnDef<PaymentHistoryData>[] = [\n    {\n      id: \"select\",\n      header: ({ table }) => (\n        <div className=\"flex justify-center px-0\">\n            <Checkbox\n            checked={\n                historyData.length > 0 &&\n                selectedHistoryIds.size === historyData.length\n            }\n            onCheckedChange={(value) => toggleAllHistory(!!value)}\n            aria-label=\"Select all\"\n            />\n        </div>\n      ),\n      cell: ({ row }) => (\n        <div className=\"flex justify-center px-0\">\n            <Checkbox\n            checked={selectedHistoryIds.has(row.original.id)}\n            onCheckedChange={() => toggleHistorySelection(row.original.id)}\n            aria-label=\"Select row\"\n            onClick={(e) => e.stopPropagation()}\n            />\n        </div>\n      ),\n      size: 30,\n    },\n    { accessorKey: \"pytRn\", header: \"납입회차\" },\n    { accessorKey: \"pytAmt\", header: \"납입금액\" },\n    { accessorKey: \"aclPytAmt\", header: \"실제납입금액\" },\n    { accessorKey: \"prcsDt\", header: \"처리일자\" },\n  ];\n\n  const popupActions: PopupAction[] = [\n    { id: \"close\", text: \"닫기\", onClick: () => window.close() },\n  ];\n\n  const detailLayout: FilterLayout = [\n      {\n          type: \"grid\",\n          columns: 3,\n          filters: [\n              { name: \"applicationDate\", type: \"text\", label: \"신청일\", readonly: true },\n              { name: \"unprocessedAmountDetail\", type: \"text\", label: \"미처리금액\", readonly: true },\n              { name: \"unprocessedBalance\", type: \"text\", label: \"미처리잔액\", readonly: true },\n          ]\n      }\n  ];\n\n  return (\n    <div className=\"flex flex-col h-screen bg-gray-50 text-sm\">\n      <div className=\"flex items-center justify-between p-4 bg-white border-b\">\n        <h1 className=\"text-xl font-bold\">미처리금액 처리</h1>\n        <PopupRightActions actions={popupActions} />\n      </div>\n\n      <div className=\"flex-1 overflow-auto p-4 flex flex-col gap-4\">\n        {/* 1. Filter Area */}\n        <div className=\"flex items-center justify-end gap-2 bg-white p-2 border rounded-sm shadow-sm\">\n          <Label htmlFor=\"unprocessedAmount\" className=\"whitespace-nowrap font-medium\">\n            미처리금액\n          </Label>\n          <Input \n            id=\"unprocessedAmount\" \n            className=\"w-48 h-8\" \n            value={unprocessedAmount}\n            onChange={(e) => setUnprocessedAmount(e.target.value)}\n          />\n          <Button variant=\"secondary\" size=\"sm\" className=\"h-8 px-3\" onClick={handleApply}>\n            적용\n          </Button>\n          <Button variant=\"secondary\" size=\"sm\" className=\"h-8 px-3\" onClick={handleSave}>\n            저장\n          </Button>\n        </div>\n\n        {/* 2. Unprocessed Target Grid */}\n        <div className=\"h-auto\"> \n          <DataTable \n              title=\"미처리적용대상\"\n              columns={targetColumns} \n              data={targetData}\n              amountColumns={[\"untAmt\"]}\n              onRowDoubleClick={handleTargetRowDoubleClick}\n          />\n        </div>\n\n        {/* 3. Detail Info (FilterContainer) */}\n        <div className=\"flex flex-col gap-1\">\n            <h3 className=\"font-semibold text-base\">미처리적용대상 상세</h3>\n            <FilterContainer \n                filterLayout={detailLayout}\n                values={detailInfo}\n                onChange={() => {}} // Readonly\n            />\n        </div>\n\n        {/* 4. Payment History Grid */}\n        <div className=\"h-auto\">\n          <DataTable \n              title=\"납입내역\"\n              columns={historyColumns} \n              data={historyData}\n              amountColumns={[\"pytAmt\", \"aclPytAmt\"]}\n          />\n        </div>\n      </div>\n\n      {/* 5. Status Bar */}\n      <div className=\"bg-gray-100 border-t p-2 text-xs text-gray-600\">\n        처리 완료되었습니다\n      </div>\n    </div>\n  );\n}"],"names":["unprocessedTargetMockData","_","i","paymentHistoryMockData","UnprocessedAmountProcessingPopup","searchParams","useSearchParams","unprocessedAmount","setUnprocessedAmount","useState","targetData","setTargetData","historyData","setHistoryData","detailInfo","setDetailInfo","useEffect","amount","handleApply","handleSave","handleTargetRowDoubleClick","row","selectedHistoryIds","setSelectedHistoryIds","toggleHistorySelection","useCallback","id","prev","newSet","toggleAllHistory","checked","d","targetColumns","historyColumns","table","jsx","Checkbox","value","e","popupActions","detailLayout","jsxs","PopupRightActions","Label","Input","Button","DataTable","FilterContainer"],"mappings":"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"}