import{j as s,r as a,U as k}from"./index-2Av6MLFj.js";import{C as p}from"./checkbox-COTNJ_PZ.js";import{F as x}from"./FilterContainer-Cxktb3TD.js";import{D as y}from"./DataTable-C4vt9fnC.js";import{P as j}from"./PopupRightActions-OdEFx9UK.js";import"./index-B6SAKWOZ.js";import"./select-Duqj-Ize.js";import"./Combination-Bip0-cB-.js";import"./format-Bs4upCOt.js";import"./popup-bus-D6rWwgNZ.js";import"./index-DmPuGcMg.js";import"./textarea-SvLRbOEg.js";import"./table-jcuTC0ZX.js";function S(){const i=k(),[o,u]=a.useState({includeHeader:!0,saveOnlyChecked:!1,includePattern:!1,selectAll:!1,addSheet:!1,closeWindow:!0,openExcel:!1}),[d,t]=a.useState([]);a.useEffect(()=>{const e=i.get("columns");if(e)try{const l=JSON.parse(e);t(l.map(c=>({accessorKey:c.accessorKey,header:c.header,checked:!0})))}catch(l){console.error("Failed to parse columns param:",l)}},[i]);const m=a.useCallback((e,l)=>{u(c=>({...c,[e]:l}))},[]),n=a.useCallback((e,l)=>{t(c=>c.map(r=>r.accessorKey===e?{...r,checked:l}:r))},[]),h=a.useCallback(e=>{t(l=>l.map(c=>({...c,checked:e})))},[]),f=a.useMemo(()=>[{type:"grid",columns:3,filters:[{name:"includeHeader",type:"checkbox",label:"수평헤더 제목포함"},{name:"saveOnlyChecked",type:"checkbox",label:"체크된 항목만 저장"},{name:"includePattern",type:"checkbox",label:"패턴 포함"}]},{type:"grid",columns:2,filters:[{name:"selectAll",type:"checkbox",label:"전체선택"},{name:"addSheet",type:"checkbox",label:"기존 파일에 시트 추가"}]}],[]),b=a.useMemo(()=>[{type:"grid",columns:2,filters:[{name:"closeWindow",type:"checkbox",label:"창닫기"},{name:"openExcel",type:"checkbox",label:"엑셀 열기"}]}],[]),g=a.useMemo(()=>[{id:"select",header:({table:e})=>s.jsx(p,{checked:e.getIsAllRowsSelected()||e.getIsSomeRowsSelected()&&"indeterminate",onCheckedChange:l=>{e.toggleAllRowsSelected(!!l),h(!!l)},"aria-label":"Select all"}),cell:({row:e})=>s.jsx(p,{checked:e.original.checked,onCheckedChange:l=>{e.toggleSelected(!!l),n(e.original.accessorKey,!!l)},"aria-label":"Select row"}),enableSorting:!1,enableHiding:!1},{accessorKey:"header",header:"열제목",cell:({row:e})=>e.original.header}],[h,n]),C=()=>{console.log("Saving with options:",{filters:o,selectedColumns:d.filter(e=>e.checked)}),alert("저장이 완료되었습니다. (콘솔 확인)"),o.closeWindow&&window.close()};return s.jsxs("div",{className:"flex flex-col gap-4 p-4 bg-gray-50 min-h-screen",children:[s.jsx("div",{className:"flex justify-between items-center",children:s.jsx("h2",{className:"text-xl font-bold",children:"엑셀 다운로드"})}),s.jsxs("div",{className:"border-t pt-4",children:[s.jsxs("div",{className:"flex flex-col gap-2 mb-4",children:[s.jsx("h3",{className:"font-semibold mb-2",children:"저장시"}),s.jsx(x,{filterLayout:f,values:o,onChange:m})]}),s.jsxs("div",{className:"flex flex-col gap-2 mb-4",children:[s.jsx("h3",{className:"font-semibold mb-2",children:"저장완료 후"}),s.jsx(x,{filterLayout:b,values:o,onChange:m})]}),s.jsx("div",{className:"flex-grow",children:s.jsx(y,{title:"저장할 열 선택",columns:g,data:d,onRowClick:e=>n(e.accessorKey,!e.checked)})})]}),s.jsx("div",{className:"flex justify-center gap-2 pt-4 pb-4",children:s.jsx(j,{actions:[{id:"save",text:"저장",onClick:C},{id:"close",text:"닫기",onClick:()=>window.close()}]})})]})}function M(){return s.jsx(a.Suspense,{children:s.jsx(S,{})})}export{M as default};
//# sourceMappingURL=page-B8D0Dzdn.js.map
