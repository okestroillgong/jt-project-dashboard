{"version":3,"file":"page-DCl7FWHi.js","sources":["../../src/pages/dashboard/after-loan/special-bond/manager-management/page.tsx"],"sourcesContent":["\n\nimport { usePathname } from \"@/lib/hooks/useAppLocation\";\nimport { useCallback, useState, useEffect } from \"react\";\nimport { usePageStore } from \"@/lib/store/pageStore\";\nimport { listenForPopupMessages } from \"@/lib/popup-bus\";\nimport {\n  Breadcrumb,\n  BreadcrumbItem,\n  BreadcrumbList,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n} from \"@/components/ui/breadcrumb\";\nimport { CustomTabs as Tabs, CustomTabsContent as TabsContent, CustomTabsList as TabsList, CustomTabsTrigger as TabsTrigger } from \"@/components/app/CustomTabs\";\nimport { RightActions, ActionType } from \"@/components/app/RightActions\";\nimport { DataTable } from \"@/components/app/DataTable\";\nimport type { FilterLayout } from \"@/components/filters/types\";\nimport { FilterContainer } from \"@/components/filters/FilterContainer\";\nimport TitleIcon from \"@/assets/icons/webp/title-icon.webp\";\nimport { ColumnDef } from \"@tanstack/react-table\";\n\n// 1. Type Definitions\ntype ManagerManagementItem = {\n  id: number;\n  managerName: string;\n  incorporationDate: string;\n  customerNo: string;\n  customerName: string;\n  accountNo: string;\n  productName: string;\n};\n\n// 2. Column Definitions\nconst createColumn = (accessorKey: string, header: string): ColumnDef<ManagerManagementItem> => ({\n  accessorKey,\n  header,\n});\n\nconst columns: ColumnDef<ManagerManagementItem>[] = [\n  createColumn(\"id\", \"순번\"),\n  createColumn(\"managerName\", \"담당자명\"),\n  createColumn(\"incorporationDate\", \"편입일자\"),\n  createColumn(\"customerNo\", \"고객번호\"),\n  createColumn(\"customerName\", \"고객명\"),\n  createColumn(\"accountNo\", \"계좌번호\"),\n  createColumn(\"productName\", \"상품명\"),\n];\n\n// 3. Mock Data\nconst mockData: ManagerManagementItem[] = Array.from({ length: 5 }, (_, i) => ({\n  id: i + 1,\n  managerName: `담당자${i + 1}`,\n  incorporationDate: \"2024-01-01\",\n  customerNo: `CUST${1000 + i}`,\n  customerName: `고객${i + 1}`,\n  accountNo: `123-45-6789${i}`,\n  productName: \"신용대출\",\n}));\n\nexport default function SpecialBondManagerManagementPage() {\n  const tabId = usePathname();\n  const { currentState, updateFilters, updateTableData, clearState } = usePageStore();\n  const [activeTab, setActiveTab] = useState(\"inquiry\");\n\n  // Popup Message Listener\n  useEffect(() => {\n    const cleanup = listenForPopupMessages((message) => {\n      if (message.targetTabId !== tabId) return;\n\n      if (message.source === \"branch-management\") {\n        const branch = message.payload;\n        updateFilters(tabId, {\n            managementBranch: { code: branch.branchCode, name: branch.branchName }\n        });\n      } else if (message.source === \"user-search\") { // Assuming user-search popup for manager\n        const user = message.payload;\n        // Determine which field to update based on active tab or message context if available\n        // For simplicity, updating both or checking current active filter logic (complex without context)\n        // Let's assume unique filter names help.\n        // inquiry: manager, registration: regManager\n        // Ideally pass a context ID to popup.\n        // Here simply update 'manager' if in inquiry, 'regManager' if in registration.\n        if (activeTab === 'inquiry') {\n             updateFilters(tabId, { manager: { code: user.userId, name: user.userName } });\n        } else {\n             updateFilters(tabId, { \n                 regManager: { code: user.userId, name: user.userName },\n                 regManagerName: user.userName \n             });\n        }\n      } else if (message.source === \"customer-search\") {\n        const customer = message.payload;\n        updateFilters(tabId, {\n            customerNo: { code: customer.centralCustomerNumber, name: customer.customerName }\n        });\n      }\n    });\n    return cleanup;\n  }, [tabId, activeTab, updateFilters]);\n\n  const handleFilterChange = useCallback(\n    (name: string, value: any) => {\n      updateFilters(tabId, { [name]: value });\n    },\n    [tabId, updateFilters]\n  );\n\n  const handleSearch = () => {\n    console.log(\"Searching...\");\n    updateTableData(tabId, 'managerTable', mockData);\n  };\n\n  const handleReset = () => {\n    clearState(tabId);\n  };\n\n  const handleRegister = () => {\n    console.log(\"Registering...\");\n  };\n\n  const handleExcelDownload = () => {\n    console.log(\"Downloading Excel...\");\n  };\n\n  // Filter Layouts\n  const inquiryFilterLayout: FilterLayout = [\n    {\n      type: \"grid\",\n      columns: 3,\n      filters: [\n        { name: \"incorporationDate\", type: \"date-range\", label: \"편입일자\" },\n        { \n            name: \"managementBranch\", \n            type: \"search\", \n            label: \"관리부점\",\n            onButtonClick: (val, e) => {\n                e?.preventDefault();\n                window.open(`/popup/branch-management?openerTabId=${tabId}`, \"BranchManagement\", \"width=1600,height=800\");\n            }\n        },\n        { \n            name: \"manager\", \n            type: \"long-search\", \n            label: \"담당자\",\n            onButtonClick: (val, e) => {\n                e?.preventDefault();\n                window.open(`/popup/user-search?openerTabId=${tabId}`, \"UserSearch\", \"width=1600,height=800\");\n            }\n        },\n        { \n            name: \"customerNo\", \n            type: \"search\", \n            label: \"고객번호\",\n            onButtonClick: (val, e) => {\n                e?.preventDefault();\n                window.open(`/popup/customer-search?openerTabId=${tabId}`, \"CustomerSearch\", \"width=1600,height=800\");\n            }\n        },\n        { name: \"accountNo\", type: \"text\", label: \"계좌번호\" },\n        { \n            name: \"isManager\", \n            type: \"select\", \n            label: \"담당여부\", \n            options: [{ value: \"Y\", label: \"Y\" }, { value: \"N\", label: \"N\" }] \n        },\n      ],\n    },\n  ];\n\n  const registrationFilterLayout: FilterLayout = [\n    {\n      type: \"grid\",\n      columns: 3,\n      filters: [\n        { \n            name: \"regManager\", \n            type: \"long-search\", \n            label: \"담당자\",\n            onButtonClick: (val, e) => {\n                e?.preventDefault();\n                window.open(`/popup/user-search?openerTabId=${tabId}`, \"UserSearch\", \"width=1600,height=800\");\n            }\n        },\n        { name: \"regManagerName\", type: \"text\", label: \"담당자명\", readonly: true },\n        { name: \"regStartDate\", type: \"date\", label: \"담당시작일\" },\n      ],\n    },\n  ];\n\n  const rightActions = activeTab === 'inquiry'\n    ? [\n        { id: 'excel' as ActionType, onClick: handleExcelDownload },\n        { id: 'search' as ActionType, onClick: handleSearch },\n        { id: 'reset' as ActionType, onClick: handleReset }\n      ]\n    : [\n        { id: 'register' as ActionType, onClick: handleRegister },\n        { id: 'reset' as ActionType, onClick: handleReset }\n      ];\n\n  if (!currentState) return null;\n\n  const rowCount = currentState.tables?.['managerTable']?.length || 0;\n\n  return (\n    <div className=\"flex flex-col gap-6 pb-10\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex items-center gap-2\">\n          <img src={TitleIcon} alt=\"타이틀 아이콘\" width={40} height={40} />\n          <h2 className=\"text-lg font-semibold\">특수채권 담당자관리</h2>\n        </div>\n        <Breadcrumb>\n          <BreadcrumbList>\n            <BreadcrumbItem>홈</BreadcrumbItem>\n            <BreadcrumbSeparator />\n            <BreadcrumbItem>여신사후</BreadcrumbItem>\n            <BreadcrumbSeparator />\n            <BreadcrumbItem>특수채권</BreadcrumbItem>\n            <BreadcrumbSeparator />\n            <BreadcrumbItem>\n              <BreadcrumbPage>특수채권 담당자관리</BreadcrumbPage>\n            </BreadcrumbItem>\n          </BreadcrumbList>\n        </Breadcrumb>\n      </div>\n\n      {/* Right Actions */}\n      <div className=\"flex justify-end\">\n        <RightActions actions={rightActions} />\n      </div>\n\n      {/* Tabs Area */}\n      <Tabs value={activeTab} onValueChange={setActiveTab} className=\"w-full\">\n        <TabsList>\n          <TabsTrigger value=\"inquiry\">조회</TabsTrigger>\n          <TabsTrigger value=\"registration\">담당자 등록</TabsTrigger>\n        </TabsList>\n\n        <TabsContent value=\"inquiry\" className=\"flex flex-col gap-4 mt-0\">\n            <FilterContainer \n                filterLayout={inquiryFilterLayout}\n                values={currentState.filters}\n                onChange={handleFilterChange}\n            />\n            \n            <DataTable \n                title=\"조회내용\"\n                columns={columns}\n                data={currentState.tables?.['managerTable'] || []}\n            />\n        </TabsContent>\n\n        <TabsContent value=\"registration\" className=\"flex flex-col gap-4 mt-0\">\n            <FilterContainer \n                filterLayout={registrationFilterLayout}\n                values={currentState.filters}\n                onChange={handleFilterChange}\n            />\n            \n            <DataTable \n                title=\"조회내용\"\n                columns={columns}\n                data={currentState.tables?.['managerTable'] || []} // Using same table for demo\n            />\n        </TabsContent>\n      </Tabs>\n    </div>\n  );\n}"],"names":["createColumn","accessorKey","header","columns","mockData","_","i","SpecialBondManagerManagementPage","tabId","usePathname","currentState","updateFilters","updateTableData","clearState","usePageStore","activeTab","setActiveTab","useState","useEffect","listenForPopupMessages","message","branch","user","customer","handleFilterChange","useCallback","name","value","handleSearch","handleReset","handleRegister","handleExcelDownload","inquiryFilterLayout","val","e","registrationFilterLayout","rightActions","_b","_a","jsxs","jsx","TitleIcon","Breadcrumb","BreadcrumbList","BreadcrumbItem","BreadcrumbSeparator","BreadcrumbPage","RightActions","Tabs","TabsList","TabsTrigger","TabsContent","FilterContainer","DataTable","_c","_d"],"mappings":"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"}